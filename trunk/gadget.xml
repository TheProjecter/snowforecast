<?xml version="1.0" encoding="UTF-8" ?> 
<Module>
  <ModulePrefs title="__UP_myname__" 
	       height="200" 
	       author="Ignacio Rodriguez" 
	       author_email="irodriguez@pegaso.ls.fi.upm.es"
               scrolling="true">
    <Require feature="dynamic-height" /> 
  </ModulePrefs>

 <UserPref name="myname" display_name="Title" required="true" default_value="Snowforecast Info"/>

  <UserPref name="mystation" display_name="Ski Resort" default_value="snow-forecast.com/resorts/La-Pinilla/6day/" datatype="enum" >
    <EnumValue value="snow-forecast.com/resorts/La-Pinilla/6day/" display_value="La Pinilla" />
    <EnumValue value="snow-forecast.com/resorts/PuertoDeNavacerrada/6day/" display_value="Puerto Navacerrada"/>
    <EnumValue value="snow-forecast.com/resorts/Valdezcaray/6day/" display_value="Valdezcaray"/>
    <EnumValue value="snow-forecast.com/resorts/Valdesqui/6day/" display_value="Valdesqui"/>
  </UserPref> 

  <UserPref name="myheight" display_name="Resort Info Altitude" default_value="bot" datatype="enum" >
    <EnumValue value="bot" display_value="Bot" />
    <EnumValue value="mid" display_value="Mid"/>
    <EnumValue value="top" display_value="Top"/>
  </UserPref> 

  <Content type="html">
  <![CDATA[ 
  <div id="content_div"></div>
  <script type="text/javascript"> 
  function displayMenu() { 
    // XML snowforecast
    
    var prefs = new _IG_Prefs(__MODULE_ID__);
    var url = "http://pallas.ls.fi.upm.es/SnowForecastServer/forecast/"+prefs.getString("mystation")+prefs.getString("myheight")+"/snowforecast.xml";
    var url2 = "http://doc.examples.googlepages.com/breakfast-data.xml"; 
 
    _IG_FetchXmlContent(url, function (response) {
           if (response == null || typeof(response) != "object" || 
                      response.firstChild == null) {
              _gel("content_div").innerHTML = "<br>"+url+"</br>"+"<i>Invalid data.</i>";
              return;
           }

         // Close up div
         var html = "<div>"; 
         
      
         // Get the name Day
         var days = response.getElementsByTagName('DAYNAME');
         var daysNumber = response.getElementsByTagName('DAYNUMBER');
         var dayColor = response.getElementsByTagName('DAYCOLOR');
         var dayTime = response.getElementsByTagName('TIME');
         var pictureWeather = response.getElementsByTagName('PICTUREWEATHER');
         var pictureWind = response.getElementsByTagName('PICTUREWIND');
         var snow = response.getElementsByTagName('SNOW');
         var rain = response.getElementsByTagName('RAIN');
         var maxColor = response.getElementsByTagName('MAXCOLOR');
         var maxTemp = response.getElementsByTagName('MAXTEMP');
         var minColor = response.getElementsByTagName('MINCOLOR');
         var minTemp = response.getElementsByTagName('MINTEMP');
         var sensation = response.getElementsByTagName('SENSATION');
         var freezing = response.getElementsByTagName('FREEZING');
         
         html += "<table align='center'  border-left=1 border-top=1>";

	 html+="<tr>";
         for(var i=0; i < 6; i++){
		html+="<td align='center' width=38><b>"+
			  days[i].childNodes[0].nodeValue+"</b>"+"<br><b>"+
			  daysNumber[i].childNodes[0].nodeValue+"</b></br>"+"</td>";
             }
	html+="</tr><tr>";
	for(var i=0; i < 6; i++){
		html+="<td align='center' width=38><b>"+days[i].childNodes[0].nodeValue+"</b>"+"<br><b>"+
			  daysNumber[i].childNodes[0].nodeValue+"</b></br>"+"</td>";
             }
         html += "</tr></table></div>";

        // Display HTML string in <div>
        _gel('content_div').innerHTML = html;
    }); 
  }
  _IG_RegisterOnloadHandler(displayMenu);
  </script>
  ]]> 
  </Content>

</Module>
