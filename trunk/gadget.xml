<?xml version="1.0" encoding="UTF-8" ?> 
<Module>
  <ModulePrefs title="__UP_myname__" 
	       height="200" 
	       author="Ignacio Rodriguez" 
	       author_email="irodriguez@pegaso.ls.fi.upm.es">
    <Require feature="dynamic-height" /> 
  </ModulePrefs>

 <UserPref name="myname" display_name="Title" required="true" default_value="Snowforecast Info"/>

  <UserPref name="mystation" display_name="Ski Resort" default_value="http://www.snow-forecast.com/resorts/La-Pinilla/6day/" datatype="enum" >
    <EnumValue value="http://www.snow-forecast.com/resorts/La-Pinilla/6day/" display_value="La Pinilla" />
    <EnumValue value="http://www.snow-forecast.com/resorts/PuertoDeNavacerrada/6day/" display_value="Puerto Navacerrada"/>
    <EnumValue value="http://www.snow-forecast.com/resorts/Valdezcaray/6day/" display_value="Valdezcaray"/>
    <EnumValue value="http://www.snow-forecast.com/resorts/Valdesqui/6day/" display_value="Valdesqui"/>
  </UserPref> 

  <UserPref name="myheight" display_name="Resort Info Altitude" default_value="bot" datatype="enum" >
    <EnumValue value="bot" display_value="Bot" />
    <EnumValue value="mid" display_value="Mid"/>
    <EnumValue value="top" display_value="Top"/>
  </UserPref> 

 <Content type="html">
   <![CDATA[ 

 <div id="content_div" style="font-size:12pt; padding:5px;">
   <p>Prueba</p>
   <script type="text/javascript">
     var html ="";
     var error = 0;
     
     // Get userprefs
     var prefs = new _IG_Prefs(__MODULE_ID__);
     html+="Prueba1";
     
     // Based on user input, display personal greeting
     function displaySnowforecast (){
     
     var url = "http://pallas.ls.fi.upm.es/SnowForecastServer/snowforecast?url=";
     var skiresort = prefs.getString("mystation");
     var height = prefs.getString("myheight");
     var urlFinal = url+skiresort+height;
     html+="Prueba2";
     html+="<br>"+urlFinal+"</br>";


     _IG_FetchXmlContent(urlFinal, function (response) {
     if (response == null || typeof(response) != "object" || 
     response.firstChild == null) {
     _gel("content_div").innerHTML = "<i>Invalid data.</i>";
     error = 1;
     }
     error = 2;
     html+="<p>Hola mundo</p>";
     
     
    })
     html+= "<br>"+error+"</br>";
     html+="<p>Hola mundo2</p>";
     _gel("content_div").innerHTML = html;
     }
     _IG_RegisterOnloadHandler(displaySnowforecast);
     _IG_AdjustIFrameHeight();
  </script>

     ]]>
 </Content> 
</Module>
